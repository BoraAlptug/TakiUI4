@using TakiUI4.Areas.Admin.Models
@model ProductViewModel
@{
    ViewData["Title"] = "Ürün İşlemleri";
}

<div>
    <div id="AddForm">
        <h3>Ürün Ekleme Formu</h3>
        <form asp-area="Admin" asp-controller="Product" asp-action="Add" method="post">
            <div class="form-group">
                <label asp-for="AddProduct.ProductName">Ürün Adı</label>
                <input asp-for="AddProduct.ProductName" class="form-control" />
            </div>

            @Html.AntiForgeryToken()
            <button type="submit" class="btn btn-primary mt-2">Kaydet</button>
        </form>
    </div>

    <div class="mt-3">
        <a asp-area="Admin" asp-controller="AdminMain" asp-action="Index" class="btn btn-success">Ana Menü</a>
        <a asp-area="Admin" asp-controller="Product" asp-action="GetList" class="btn btn-info">Ürünleri Listele</a>
    </div>

    @if (Model.ProductList != null && Model.ProductList.Count > 0)
    {
        <div class="mt-4">
            <table class="table table-bordered table-striped">
                <thead>
                    <tr>
                        <th>Ürün ID</th>
                        <th>Ürün Adı</th>
                        <th>Resim Ekle</th>
                        <th>Sil</th>
                        <th>Resimler</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.ProductList)
                    {
                        <tr>
                            <td>@item.ProductID</td>
                            <td>@item.ProductName</td>

                            <td>
                                <form asp-area="Admin" asp-controller="Product" asp-action="AddImages" method="post" enctype="multipart/form-data">
                                    <input type="hidden" name="ProductID" value="@item.ProductID" />
                                    <input type="file" name="ProductImageList" multiple class="form-control" />
                                    @Html.AntiForgeryToken()
                                    <button type="submit" class="btn btn-sm btn-secondary mt-1">Resim Ekle</button>
                                </form>
                            </td>

                            <td>
                                <form asp-area="Admin" asp-controller="Product" asp-action="Delete" method="post">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="ProductID" value="@item.ProductID" />
                                    <button type="submit" class="btn btn-sm btn-danger">Sil</button>
                                </form>
                            </td>

                            <td>
                                @if (item.ProductImageList != null && item.ProductImageList.Count > 0)
                                {
                                    foreach (var image in item.ProductImageList)
                                    {
                                        <div class="mb-2 border p-2">
                                            <img src="@image.ImageUrl" alt="Resim" style="max-height:100px;" />
                                            <div>Boyut: @image.Width x @image.Height</div>
                                            <div>Dosya: @image.FileSizeMB MB</div>
                                            <div>ID: @image.ProductImageID</div>
                                            <form asp-area="Admin" asp-controller="Product" asp-action="DeleteImage" method="post">
                                                @Html.AntiForgeryToken()
                                                <input type="hidden" name="ProductImageID" value="@image.ProductImageID" />
                                                <button type="submit" class="btn btn-sm btn-danger mt-1">Sil</button>
                                            </form>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <span>Resim yok</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>
